{% extends 'recipes/base.html' %}
{% load static %}

{% block title %}Saved Recipes - Recipe App{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="page-header">
  <div class="container">
    <h1 class="page-title">Saved Recipes</h1>
    <p class="page-subtitle">Your personal collection of saved recipes and cooking insights</p>
  </div>
</section>

<!-- Main Content -->
<section class="recipes-section">
  <div class="container">
    {% if favorite_recipes %}
    <!-- Recipe Stats -->
    <div class="recipe-stats-wrapper">
      <div class="recipe-stats-card">
        <span class="stat-number">{{ total_favorites }}</span>
        <span class="stat-label">Saved Recipe{{ total_favorites|pluralize }}</span>
      </div>
    </div>

    <!-- Recipes Grid -->
    <div class="recipe-grid">
      {% for recipe in favorite_recipes %}
      <div class="recipe-card">
        <div class="recipe-image">
          {% if recipe.image %}
          <img src="{{ recipe.image.url }}" alt="{{ recipe.name }}" loading="lazy">
          {% else %}
          <div class="placeholder-image">
            <span class="placeholder-icon">ğŸ½ï¸</span>
          </div>
          {% endif %}
          <div class="recipe-overlay">
            <span class="difficulty {{ recipe.difficulty|lower }}">{{ recipe.difficulty }}</span>
          </div>
        </div>

        <div class="recipe-content">
          <h3 class="recipe-title">
            <a href="{% url 'recipes:recipe_detail' recipe.id %}">{{ recipe.name }}</a>
          </h3>
          <p class="recipe-description">{{ recipe.description|truncatewords:15 }}</p>

          <div class="recipe-meta">
            <span class="meta-item">
              <span class="meta-icon">â±ï¸</span>
              {{ recipe.total_time }} min
            </span>
            <span class="meta-item">
              <span class="meta-icon">ğŸ‘¥</span>
              {{ recipe.servings }}
            </span>
            <span class="meta-item">
              <span class="meta-icon">ğŸ·ï¸</span>
              {{ recipe.get_category_display }}
            </span>
          </div>

          <div class="recipe-actions">
            <a href="{% url 'recipes:recipe_detail' recipe.id %}" class="btn btn-primary btn-small">
              View Recipe
            </a>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
      <div class="empty-icon">ğŸ’</div>
      <h2>No saved recipes yet!</h2>
      <p>Start exploring recipes and save your favorites for easy access.</p>
      <a href="{% url 'recipes:recipes_list' %}" class="btn btn-primary">Browse Recipes</a>
    </div>
    {% endif %}
  </div>
</section>

<!-- Personal Cooking Insights Section -->
{% if has_charts and total_favorites > 0 %}
<section class="cooking-insights-section">
  <div class="container">
    <h2 class="insights-title">Your Cooking Insights</h2>
    <p class="insights-subtitle">Discover patterns in your saved recipes to make smarter cooking decisions</p>

    <div class="charts-grid">
      <!-- Ingredients Bar Chart -->
      {% if charts.ingredients_chart %}
      <div class="chart-card">
        <div class="chart-header">
          <h3>ğŸ›’ Shopping List Essentials</h3>
          <p>Stock up on these ingredients based on your saved recipes</p>
        </div>
        <div class="chart-image-container">
          <img src="data:image/png;base64,{{ charts.ingredients_chart }}" alt="Most Common Ingredients Chart"
            class="chart-image">
        </div>
      </div>
      {% endif %}

      <!-- Categories Pie Chart -->
      {% if charts.categories_chart %}
      <div class="chart-card">
        <div class="chart-header">
          <h3>ğŸ½ï¸ Your Recipe Preferences</h3>
          <p>See what types of meals you love to save</p>
        </div>
        <div class="chart-image-container">
          <img src="data:image/png;base64,{{ charts.categories_chart }}" alt="Recipe Categories Distribution Chart"
            class="chart-image">
        </div>
      </div>
      {% endif %}

      <!-- Cooking Time Line Chart -->
      {% if charts.cooking_time_chart %}
      <div class="chart-card">
        <div class="chart-header">
          <h3>â±ï¸ Your Time Preferences</h3>
          <p>Understand your cooking time patterns</p>
        </div>
        <div class="chart-image-container">
          <img src="data:image/png;base64,{{ charts.cooking_time_chart }}" alt="Cooking Time Preferences Chart"
            class="chart-image">
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</section>
{% endif %}

<!-- Footer -->
<footer class="site-footer">
  <div class="container">
    <p>&copy; 2026 Recipe App. Made with Django and â¤ï¸</p>
  </div>
</footer>


{% endblock %}